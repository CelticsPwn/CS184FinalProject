    <html>

    <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]} });
    </script>
    <title>CS184 Final Project</title>
    <meta charset="UTF-8">
    </script>
    <style>
    body,
    html {
        font-size: 62.5%
    }

    body {
        line-height: 1;
        font: 16px "Helvetica Neue", Helvetica, Arial, sans-serif;
        color: #666
    }
    </style>
    <title>Final Project</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">
    </head>


    <body>
    <div class="post">

    <h1 align="middle">Final Deliverable: Black Hole Raymarcher</h1>
    <span class="date">Kenny Chen, Leonardo Tang, Lawrence Zhao</span>

    <h2>Abstract</h2>
    <p>We present an approach to render a realistic black hole in real time on the web using Three.js and
        GLSL. We use a fully shader-based approach and render a raymarched scene to simulate how light
        interacts with the black hole. We make approximations to physically-accurate equations in order
        to achieve real-time speeds.
        In addition, we demonstrate that adding a postprocessing bloom filter makes our render
        more interesting.
    </p>

    <h2>Technical Approach</h2>
    <p>We detail our technical approach below:</p>
    <h3>Gravitational Lensing</h3>
    <p>
        Gravitational lensing is an effect predicted by Albert Einsteinâ€™s general theory of relativity that
        describes how light is bent as it travels toward an observer. This effect is most noticeable for
        large masses, and is therefore very prominent in black holes.
    </p>
    <br>
    <p>
        We model this effect using the Einstein ring equation, which describes the deformation with respect
        to the mass of the lens, $M$, distance to the lense $D_L$, distance to the source $D_S$, and distance between the
        lens and source $D_{LS}$,
        $$\theta_1=\sqrt{\frac{4GM}{c^2}\frac{D_{LS}}{D_SD_L}}$$
    </p>
    <br>
    <p>
        where $G$ is the gravitational constant and $c$ is the speed of light.
        We modify this equation a bit to create the effects we desire.
    </p>
    <br>
    <p>
        In our shader program, we apply this deformation to the vector pointing from the center of the black
        hole to the current location being shaded and sample the texture at that location. To model the effect
        of light not being able to escape past the event horizon, we determine if the texture location being
        sampled is outside of the Schwarzchild radius. If it is inside this radius, we just set the color to
        black.
    </p>
    <br>
    <p>Below is a demo of our gravitational lensing shader from our milestone deliverable.</p>
    <br>
    <iframe width="960" height="569" src="src/lensing.html"></iframe>
    <center>You can access a full screen of the web app <a href="src/lensing.html" target="_blank">here</a>.</center>
    <h3>Raymarching</h3>
    <h3>Extra Physics</h3>
    <h3>Post Processing</h3>
    <p>
        To make the overall visual more appealing and closer to the interstellar rendition, we added a bloom
        filter to the image produced by our render. To do so, we took advantage of the Effect Composer in
        Three.js, which lets us set up a simple post processing pipeline. First we use a render pass to render
        the scene to a render target, and then we use a bloom pass to add the bloom filter to the image, which
        we then render to the screen. We chose to use the Unreal Bloom Pass filter, with parameters {exposure = 2,
        threshold = 0.5, strength = 0.25, and radius = 0.25}.
    </p>
    <br>
    <p>
        Below we have examples of the rendered model before and after we applied the bloom filter. As you can see,
        before the bloom filter was utilized, the accretion disk looks rather thin and is dominated by a red color.
        After the bloom filter, the accretion disk takes on a much brighter, blinding white color. This is desirable
        since we were aiming for a picture closer to the black hole render in Interstellar, requiring a brighter,
        harsher light that seems a bit more magical than a mundane red ring.
    </p>
    <br>
    <div class="row">
        <div class="column">
            <img src="images/no_bloom.PNG" style="width: 100%;">
            <figcaption>Without Bloom Filter</figcaption>
        </div>
        <div class="column">
            <img src="images/with_bloom.PNG" style="width: 100%;">
            <figcaption>With Bloom Filter</figcaption>
        </div>
    </div>
    <h2>Results</h2>

    <p>You can access the full screen version of our black hole renderer below. WARNING: rendering a black hole through raymarching requires a significant amount of computational power, so opening the link may slow down your computer. Take note of how the accretion disk orbits around the black hole, how the background moves as the viewing camera orbits around the black hole, and how the black hole distorts the section of the background image behind it. </p>
    <br>
    <p><a href="src/black_hole.html">Black Hole Renderer</a></p>
    <br>
    <p>For those of you who may not have a computer powerful enough to fully appreciate the final product, you can watch the video below to see a short demo. </p>

    <h2>Video</h2>
    <iframe width="960" height="535" src="https://www.youtube.com/embed/1sCLiSIwiuU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <h2>Slides</h2>
    <iframe src="https://docs.google.com/presentation/d/e/2PACX-1vRTRBFt2ED-MQ_1cfebABJo_wnOInIUbAZNeRgoucvtfrGbMyr63xDmSwgdjaDbx3hWn2wYxZsl2lqj/embed?start=true&loop=true&delayms=5000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

    <h2>References</h2>
    <h2>Contributions of Each Team Member</h2>

    <h3>Kenny Chen</h3>
    <ol>
    	<li>- Set up initial Three.js scene and GLSL files</li>
    	<li>- Wrote fragment shader for modeling gravitational lensing</li>
    	<li>- Helped write javascript functions that repeatedly run raymarching algorithm</li>
    </ol>

    <h3>Leonardo Tang</h3>
    <ol>
    	<li>- Wrote camera movement javascript file</li>
    	<li>- Helped write javascript functions that repeatedly run raymarching algorithm</li>
    	<li>- Added post-processing</li>
    </ol>

    <h3>Lawrence Zhao</h3>
    <ol>
    	<li>- Wrote raymarching algorithm in vertex shader</li>
    	<li>- Implemented extra physical light effects</li>
    </ol>

    <center><a href="index.html">Return to Home Page</a></center>
    <br><br><br>

    </div>

    </body>

    </html>
